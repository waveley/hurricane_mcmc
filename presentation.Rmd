---
title: |
  | P8160 - Bayesian Modeling of Hurricane Trajectories
author: |
  | Paulina Han, Waveley Qiu, Yida Wang,
  | Lin Yang, Jibei Zheng, Haolin Zhong
date: "2022-05-09"
output:
  beamer_presentation:
    colortheme: "dolphin"
header-includes:
  - \usepackage{algpseudocode}
  - \usepackage{amsmath}
  - \usepackage{setspace}
  - \usepackage{scrextend}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## Introduction

### Data Preparation

- Self-join was performed to generate data for Gibbs sampling

- For each hurricane, 80%/20% of records were randomly assigned to the training/test dataset. Hurricanes with less than 5 records were removed.

## Gibbs Sampling

\begin{addmargin}[2em]{1em}
\begin{spacing}{1.5}
\Large
\begin{algorithmic}
\State Initialize $\Theta_0 = ( \mathbf B_0, \boldsymbol{\mu}_0, \sigma_0^2, \Sigma_0) $
\For{iteration i = 1,2,...} 
    \State Sample $\mathbf B_i \sim \pi(\mathbf B|\boldsymbol{\mu}_{i-1}, \sigma_{i-1}^2, \Sigma_{i-1}, \mathbf Y) $
    \State Sample $\boldsymbol \mu_i \sim \pi(\boldsymbol \mu|\mathbf{B}_{i}, \sigma_{i-1}^2, \Sigma_{i-1}, \mathbf Y) $
    \State Sample $\sigma_i^2 \sim \pi(\sigma^2|\mathbf{B}_{i}, \boldsymbol \mu_i, \Sigma_{i-1}, \mathbf Y) $
    \State Sample $\Sigma_i \sim \pi(\Sigma|\mathbf{B}_{i}, \boldsymbol \mu_i, \sigma_i^2, \mathbf Y) $
\EndFor
\end{algorithmic}
\normalsize
\end{spacing} 
\end{addmargin}

## Results

![]("plots/beta.png")

## Results

![]("plots/mu.png")

## Results

![]("plots/sigmasq.png")

\vspace{5mm}

![]("plots/SIGMA2.png")

## EDA of $\beta_i$
![]("plots/p5_1.png")

## EDA of $\beta_i$
![]("plots/p5_2.png")

## Seasonal Analysis

Model 1: $Beta_{i} = \alpha_{0} + \alpha_{1}I(\textrm{Month} = M ) + \alpha_{2}\times \textrm{Year} + \alpha_{3}I(\textrm{Type} = N )$ 

Coefficients of Model 1 for $\beta_{i}$
![]("plots/p5_4.png")

## Seasonal Analysis
Model 2: $Beta_{i} = \alpha_{0} + \alpha_{1}I(\textrm{Season} = S ) + \alpha_{2}\times \textrm{Year} + \alpha_{3}I(\textrm{Type} = N )$ 

Coefficients of Model 2 for $\beta_{i}$
![]("plots/p5_3.png")



## Forcasting Hurricane Impact

**ID**: ID of the hurricanes\
**Season**: In which year the hurricane occurred\
**Month**: In which month the hurricane occurred\
**Nature**: Nature of the hurricane\
**Damage**: Financial loss (in Billion U.S. dollars) caused by hurricanes\
**Deaths**: Number of death caused by hurricanes\
**Maxspeed**: Maximum recorded wind speed of the hurricane\
**Meanspeed**: Average wind speed of the hurricane\
**Maxpressure**: Maximum recorded central pressure of the hurricane\
**Meanpressure**: Average central pressure of the hurricane\
**Hours**: Duration of the hurricane in hours\
**Total.Pop**:  Total affected population\
**Percent.Poor**: \% affected population that reside in low GDP counties\
**Percent.USA**:  \% affected population that reside in the United States 

## LASSO Model for Damage


\centering
![]("plots/LASSO_coefficients.png"){height=300}

## Refitted Linear Regression Model

Model:  Y = $\gamma_0$ + $\gamma_1$ x season + $\gamma_2$ x maxspeed + $\gamma_3$ x total\_pop + $\gamma_4$ x percent\_usa 

\vspace{5mm}

![]("plots/refitted_linearmodel.png"){height=150}

## Poisson Model for Dealths

![]("plots/Poisson_coefficients.png"){height=300}

## Discussion

### Strength & Limitation of MCMC methods

\vskip 10pt

- Bypass coefficient optimization process and directly sample coefficients from their assumed distributions

\vskip 10pt

- Often computationally expensive and can be inefficient

\vskip 10pt

- Convergence is not guaranteed

## Why Non-convergence?

- $\boldsymbol \beta_i \sim N(\boldsymbol \beta, \Sigma)$ may be a too strong assumption

![Distribution of $\boldsymbol \beta_i$s obtained by performing OLS for each hurricane (red line: $\boldsymbol \beta$ obtained by performing OLS on the whole training dataset)]("plots/discussion.png")

- **Future work**: use a more adequate distribution assumption of $\boldsymbol \beta_i$ which can account for skewness



